<!-- 第1段：宝宝信息横幅 -->
<view class="status-overview">
  <view class="baby-info">
    <!-- 头像区域，点击可编辑 -->
    <view class="avatar" bindtap="editBabyInfo">
      <text class="avatar-text">{{babyInfo.name ? babyInfo.name.substring(0,2) : '宝宝'}}</text>
    </view>
    <view class="info-text">
      <!-- 姓名和编辑图标 -->
      <view class="name-section">
        <text class="name">{{babyInfo.name || '宝宝'}} · {{babyInfo.age || '0岁0个月'}}</text>
        <text class="edit-icon" bindtap="editBabyInfo">✏️</text>
      </view>
      <text class="mood">{{babyInfo.healthStatus || '点击设置宝宝信息'}}</text>
    </view>
  </view>
  <view class="checkin-section">
    <view class="checkin-stats">
      <text class="days">健康评分 {{babyInfo.healthRating || 0}}分</text>
    </view>
    <view class="actions">
      <view class="action-icon" bindtap="handleCheckin">
        <view class="icon">📅</view>
        <text class="icon-text">签到</text>
      </view>
      <view class="action-icon" bindtap="handleShare">
        <view class="icon">↗️</view>
        <text class="icon-text">分享</text>
      </view>
    </view>
  </view>
</view>

<!-- 第2段：关心宝贝功能区 -->
<view class="care-section">
  <view class="care-title">❤️ 关心宝贝</view>
  <view class="function-grid">
    <view class="function-item" bindtap="navToBabyStatus">
      <view class="function-icon">📊</view>
      <text class="function-text">我宝情况</text>
    </view>
    <!-- 在这里添加饮食记录 -->
    <view class="function-item" bindtap="navToDietRecord">
      <view class="function-icon">🍽️</view>
      <text class="function-text">饮食记录</text>
    </view>
    <view class="function-item" bindtap="navToMap">
      <view class="function-icon">🗺️</view>
      <text class="function-text">看看周围</text>
    </view>
    <view class="function-item" bindtap="navToDiary">
      <view class="function-icon">📔</view>
      <text class="function-text">心情日记</text>
    </view>
  </view>
</view>

<!-- 第3段：健康趋势图表 -->
<view class="chart-section">
  <view class="chart-header">
    <view class="header-left">
      <text class="chart-title">健康趋势</text>
      <text class="chart-desc">基于最近情况数据计算 · 当前评分: {{currentHealthIndex}}</text>
    </view>
    <view class="header-right">
      <text class="refresh-btn" bindtap="refreshHealthData">刷新</text>
    </view>
  </view>

  <view class="health-levels">
    <view class="level-item {{currentHealthIndex >= 90 ? 'active' : ''}}">
      <text class="level-text">优秀</text>
      <text class="level-range">90-100</text>
    </view>
    <view class="level-item {{currentHealthIndex >= 80 && currentHealthIndex < 90 ? 'active' : ''}}">
      <text class="level-text">良好</text>
      <text class="level-range">80-89</text>
    </view>
    <view class="level-item {{currentHealthIndex >= 70 && currentHealthIndex < 80 ? 'active' : ''}}">
      <text class="level-text">一般</text>
      <text class="level-range">70-79</text>
    </view>
    <view class="level-item {{currentHealthIndex >= 60 && currentHealthIndex < 70 ? 'active' : ''}}">
      <text class="level-text">关注</text>
      <text class="level-range">60-69</text>
    </view>
    <view class="level-item {{currentHealthIndex < 60 ? 'active' : ''}}">
      <text class="level-text">需重视</text>
      <text class="level-range">&lt;60</text>
    </view>
  </view>

  <!-- 折线图容器 -->
  <view class="line-chart-container">
    <view class="chart-bg">
      <!-- Y轴标签 -->
      <view class="y-axis">
        <text class="y-label">100</text>
        <text class="y-label">80</text>
        <text class="y-label">60</text>
        <text class="y-label">40</text>
        <text class="y-label">20</text>
        <text class="y-label">0</text>
      </view>
      
      <!-- 图表区域 -->
      <view class="chart-area">
        <!-- 网格线 -->
        <view class="grid-horizontal"></view>
        <view class="grid-horizontal"></view>
        <view class="grid-horizontal"></view>
        <view class="grid-horizontal"></view>
        <view class="grid-horizontal"></view>
        
        <!-- 折线路径 - 移除复杂的clip-path -->
        <view class="line-path"></view>
        
        <!-- 数据点 -->
        <block wx:for="{{healthTrendData}}" wx:key="date">
          <view 
            class="data-point {{currentHealthIndex === item.healthIndex ? 'active' : ''}}" 
            style="left: {{(100 / (healthTrendData.length - 1)) * index}}%; bottom: {{item.healthIndex}}%;"
            bindtap="onDataPointTap"
            data-index="{{index}}"
            data-item="{{item}}"
          >
            <view class="point-tooltip">{{item.displayDate}}: {{item.healthIndex}}分</view>
          </view>
        </block>
      </view>
    </view>
    
    <!-- X轴日期 -->
    <view class="x-axis">
      <block wx:for="{{healthTrendData}}" wx:key="date">
        <text class="x-label">{{item.displayDate}}</text>
      </block>
    </view>
  </view>
</view>

<!-- 第4段：其他内容 -->
<view class="quick-record-section">
  <view class="section-title">📝 今日快速记录</view>
  <view class="quick-actions">
    <view class="action-item" bindtap="quickRecord" data-type="mood">
      <view class="action-icon">😊</view>
      <text class="action-text">情绪</text>
    </view>
    <view class="action-item" bindtap="quickRecord" data-type="diet">
      <view class="action-icon">🍽️</view>
      <text class="action-text">饮食</text>
    </view>
    <view class="action-item" bindtap="quickRecord" data-type="sleep">
      <view class="action-icon">😴</view>
      <text class="action-text">睡眠</text>
    </view>
    <view class="action-item" bindtap="quickRecord" data-type="exercise">
      <view class="action-icon">🏃</view>
      <text class="action-text">运动</text>
    </view>
    <view class="action-item" bindtap="quickRecord" data-type="special">
      <view class="action-icon">🆘</view>
      <text class="action-text">特殊</text>
    </view>
  </view>
</view>
<!-- 第5段：经验交流预览（美化版） -->
<view class="experience-section">
  <!-- 头部 -->
  <view class="experience-header">
    <view class="experience-header-left">
      <view class="experience-title-row">
        <view class="experience-title-bar"></view>
        <text class="experience-title">🤝 经验交流</text>
      </view>
      <text class="experience-subtitle">妈妈们的真实经验分享</text>
    </view>

    <view class="experience-more-wrap" bindtap="goToExperienceList">
      <text class="experience-more-text">更多</text>
      <text class="experience-more-arrow">›</text>
    </view>
  </view>

  <!-- 有帖子时：展示几条热门经验 -->
  <block wx:if="{{hotPosts && hotPosts.length}}">
    <block wx:for="{{hotPosts}}" wx:key="id">
  <view class="experience-card" bindtap="goToExperienceList">
    <view class="card-title-row">
      <text class="card-title">{{item.title}}</text>
        </view>

        <view class="card-meta-row">
          <text class="card-author">{{item.author}}</text>
        </view>

        <view class="card-stat-row">
          <view class="card-stat">
            <text class="card-stat-icon">👍</text>
            <text class="card-stat-text">{{item.likes || 0}}</text>
          </view>
          <view class="card-stat">
            <text class="card-stat-icon">💪</text>
            <text class="card-stat-text">{{item.cheers || 0}}</text>
          </view>
        </view>
      </view>
    </block>
  </block>

  <!-- 没有帖子时 -->
  <block wx:else>
    <view class="experience-empty">
      <text class="empty-title">还没有经验分享</text>
      <text class="empty-text">可以在「经验交流」里发布第一条经验～</text>
    </view>
  </block>
</view> <!-- 这里是经验交流卡片的结尾 -->

<!-- 和我聊聊 -->
<view class="chat-section">
  <view class="chat-card">
    <view class="chat-left">
      <view class="chat-title-row">
        <text class="chat-emoji">🙋‍♀️</text>
        <text class="chat-title">和我聊聊</text>
      </view>
      <text class="chat-subtitle">
        有困惑、想问问题，都可以加我企业微信私聊
      </text>
    </view>

    <view class="chat-right" bindtap="openChatModal">
      <text class="chat-btn-text">点我联系</text>
    </view>
  </view>
</view>
<!-- 企业微信二维码弹层 -->
<view 
  class="chat-modal-mask" 
  wx:if="{{showChatModal}}" 
  catchtouchmove="true"
>
  <view class="chat-modal">
    <view class="chat-modal-header">
      <text class="chat-modal-title">加我企业微信</text>
      <text class="chat-modal-close" bindtap="closeChatModal">✕</text>
    </view>

    <view class="chat-modal-body">
      <text class="chat-modal-desc">
        截图 / 保存后，用企业微信扫一扫添加我为好友。
      </text>

      <!-- 🎨 这里是代替二维码的色块 -->
      <view class="qrcode-placeholder">
        <text class="qrcode-placeholder-text">企业微信二维码占位</text>
      </view>
    </view>

    <button class="chat-modal-btn" bindtap="closeChatModal">
      我知道了
    </button>
  </view>
</view>
<view class="history-page">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-back-btn" bindtap="goBack">
      <text class="back-icon">â€¹</text>
      <text class="back-text">è¿”å›</text>
    </view>
    <text class="header-title">èº«é«˜ä½“é‡è®°å½•</text>
    <view class="header-right"></view>
  </view>

  <!-- è¶‹åŠ¿å›¾è¡¨ -->
  <view class="chart-section" wx:if="{{historyData.length > 0}}">
    <view class="chart-tabs">
      <view class="chart-tab {{currentChart === 'height' ? 'active' : ''}}" bindtap="switchChart" data-type="height">
        <text class="tab-text">èº«é«˜è¶‹åŠ¿</text>
        <view class="tab-indicator"></view>
      </view>
      <view class="chart-tab {{currentChart === 'weight' ? 'active' : ''}}" bindtap="switchChart" data-type="weight">
        <text class="tab-text">ä½“é‡è¶‹åŠ¿</text>
        <view class="tab-indicator"></view>
      </view>
    </view>

    <!-- å›¾è¡¨å®¹å™¨ -->
    <view class="chart-container">
      <view class="chart-header">
        <text class="chart-title">{{currentChart === 'height' ? 'èº«é«˜å¢é•¿è¶‹åŠ¿' : 'ä½“é‡å¢é•¿è¶‹åŠ¿'}}</text>
        <text class="chart-unit">{{currentChart === 'height' ? '(cm)' : '(kg)'}}</text>
        <text class="chart-subtitle">è¿‘{{recentDays}}å¤©æ•°æ®</text>
      </view>
      
      <view class="chart-area">
        <!-- å›¾è¡¨å†…å®¹ -->
        <view class="chart-content">
          <!-- å›¾è¡¨ç½‘æ ¼ -->
          <view class="chart-grid">
            <view class="grid-line" wx:for="{{5}}" wx:key="index"></view>
          </view>
          
          <!-- èº«é«˜å›¾è¡¨ -->
          <view class="chart-line" wx:if="{{currentChart === 'height'}}">
            <view wx:for="{{recentHeightData}}" wx:key="date" class="chart-point" 
                  style="left: {{item.position}}%; bottom: {{item.heightPosition}}%;">
              <text class="point-value">{{item.height}}</text>
              <view class="point-dot"></view>
            </view>
            <view class="chart-line-path height-line" style="height: {{chartLineHeight}}%;"></view>
          </view>
          
          <!-- ä½“é‡å›¾è¡¨ -->
          <view class="chart-line" wx:if="{{currentChart === 'weight'}}">
            <view wx:for="{{recentWeightData}}" wx:key="date" class="chart-point" 
                  style="left: {{item.position}}%; bottom: {{item.weightPosition}}%;">
              <text class="point-value">{{item.weight}}</text>
              <view class="point-dot"></view>
            </view>
            <view class="chart-line-path weight-line" style="height: {{chartLineHeight}}%;"></view>
          </view>
        </view>
        
        <!-- Xè½´æ—¥æœŸ -->
        <view class="x-axis">
          <view wx:for="{{currentChart === 'height' ? recentHeightData : recentWeightData}}" 
                wx:key="date" class="x-axis-label" style="left: {{item.position}}%;">
            <text class="x-axis-date">{{item.chartDate}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è®°å½•åˆ—è¡¨ -->
  <view class="record-list" wx:if="{{historyData.length > 0}}">
    <view class="list-header">
      <text class="list-title">å†å²è®°å½•</text>
      <text class="list-count">å…±{{historyData.length}}æ¡è®°å½•</text>
    </view>
    
    <view class="record-items">
      <view wx:for="{{historyData}}" wx:key="date" class="record-item">
        <view class="record-main">
          <view class="record-date-info">
            <text class="date-main">{{item.displayDate}}</text>
            <text class="date-weekday">{{item.weekday}}</text>
          </view>
          
          <view class="record-stats">
            <view class="stat-item">
              <text class="stat-label">èº«é«˜</text>
              <text class="stat-value">{{item.height}}<text class="stat-unit">cm</text></text>
            </view>
            <view class="stat-divider"></view>
            <view class="stat-item">
              <text class="stat-label">ä½“é‡</text>
              <text class="stat-value">{{item.weight}}<text class="stat-unit">kg</text></text>
            </view>
          </view>
        </view>
        
        <view class="record-actions">
          <text class="delete-btn" bindtap="deleteRecord" data-date="{{item.date}}">
            <text class="delete-icon">Ã—</text>
            åˆ é™¤
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{historyData.length === 0}}">
    <view class="empty-content">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-title">æš‚æ— èº«é«˜ä½“é‡è®°å½•</text>
      <text class="empty-desc">è®°å½•å®å®æˆé•¿ï¼Œè¿½è¸ªå‘è‚²è¶‹åŠ¿</text>
      <view class="empty-btn" bindtap="goToEdit">
        <text class="empty-btn-text">ç«‹å³è®°å½•</text>
      </view>
    </view>
  </view>
</view>